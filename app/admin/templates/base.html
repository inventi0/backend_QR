<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{% block title %}Admin{% endblock %}</title>
  <link rel="stylesheet" href="/admin/static/admin.css">
</head>
<body>
<nav class="topbar">
  <div class="brand"><a href="/admin/dashboard">Admin</a></div>
  <div class="spacer"></div>
  <button id="logoutBtn" class="btn danger">Выйти</button>
</nav>
<main class="container">
  {% block content %}{% endblock %}
</main>
<script>
  const TOKEN_KEY = "admin_jwt";

  function setToken(t){ localStorage.setItem(TOKEN_KEY, t); }
  function getToken(){ return localStorage.getItem(TOKEN_KEY); }
  function clearToken(){ localStorage.removeItem(TOKEN_KEY); }

  document.getElementById("logoutBtn")?.addEventListener("click", ()=>{
    clearToken();
    location.href = "/admin/login";
  });

  async function authFetch(url, options = {}){
    const token = getToken();
    const headers = new Headers(options.headers || {});
    if (token) headers.set("Authorization", "Bearer " + token);
    return fetch(url, { ...options, headers });
  }
</script>
{% block scripts %}{% endblock %}
</body>
</html>
